<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EchoMatch</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Rubik+Spray+Paint&display=swap" rel="stylesheet">
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body,html{height:100%;font-family:'Press Start 2P', monospace;background:#000;color:#0f0;overflow:hidden;}

  /* Preloader */
  #loader{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;flex-direction:column;background:#000;z-index:9999;color:#0f0;font-family:'Press Start 2P',monospace;}
  #loader::before{content:"";position:absolute;inset:0;background:repeating-linear-gradient(180deg, rgba(0,255,0,0.07) 0 2px, transparent 2px 4px);mix-blend-mode: overlay;pointer-events:none;animation:scan 6s linear infinite;}
  @keyframes scan{0%{background-position-y:0;}100%{background-position-y:100vh;}}
  #loader h1{margin-bottom:20px;font-family:'Rubik Spray Paint'; font-size:24px; text-shadow:2px 2px #0ff, -2px -2px #0f0;}
  .dots span{display:inline-block;width:8px;height:8px;margin:0 4px;background:#0f0;border-radius:50%;animation:blink 1.4s infinite both;}
  .dots span:nth-child(1){animation-delay:0s;} .dots span:nth-child(2){animation-delay:0.2s;} .dots span:nth-child(3){animation-delay:0.4s;}
  @keyframes blink{0%,80%,100%{opacity:0;}40%{opacity:1;}}

  .center{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;height:100%;padding:20px;}

  /* Login */
  .login{z-index:300;position:absolute;inset:0;background:#000;}
  .login h1{font-family:'Rubik Spray Paint';font-size:3em;color:#f06;text-shadow:2px 2px #0ff;margin-bottom:20px;}
  .login input{background:#000;border:1px solid #0f0;color:#0f0;padding:8px;margin:6px;font-size:12px;width:200px;text-align:center;}
  .login button{background:#f06;color:#000;font-weight:bold;border:none;padding:8px 16px;margin-top:10px;cursor:pointer;font-size:12px;}
  .login button:hover{background:#ff3399;}

  /* Intro */
  .intro{display:none;z-index:200;position:absolute;inset:0;background:#000;flex-direction:column;align-items:center;padding:20px;}
  .intro h1{font-family:'Rubik Spray Paint',cursive;font-size:3em;color:#f06;text-shadow:2px 2px #0ff, -2px -2px #0f0;margin-bottom:20px;}
  .press{margin-top:20px;color:#0ff;font-size:12px;animation:blink 1s step-start infinite;}

  /* Glitch */
  .glitch{position:relative;display:inline-block;animation:skew 1.5s infinite;}
  .glitch::before,.glitch::after{content:attr(data-text);position:absolute;left:0;top:0;width:100%;overflow:hidden;}
  .glitch::before{color:#f0f;clip:rect(0,900px,0,0);animation:glitchTop 2s infinite;}
  .glitch::after{color:#0ff;clip:rect(0,900px,0,0);animation:glitchBottom 1.5s infinite;}
  @keyframes skew{20%{transform:skew(5deg)}40%{transform:skew(-5deg)}60%{transform:skew(3deg)}80%{transform:skew(-2deg)}}
  @keyframes glitchTop{0%{clip:rect(0,9999px,0,0)}20%{clip:rect(0,9999px,50px,0)}40%{clip:rect(0,9999px,0,0)}60%{clip:rect(0,9999px,30px,0)}100%{clip:rect(0,9999px,0,0)}}
  @keyframes glitchBottom{0%{clip:rect(0,9999px,0,0)}20%{clip:rect(50px,9999px,80px,0)}40%{clip:rect(0,9999px,0,0)}60%{clip:rect(70px,9999px,100px,0)}100%{clip:rect(0,9999px,0,0)}}

  /* Chat */
  .app{display:none;flex-direction:column;height:100vh;padding:16px;}
  .title{font-family:'Rubik Spray Paint';font-size:1.5em;color:#f06;text-shadow:1px 1px #0ff;margin-bottom:10px;}
  .messages{flex:1;overflow:auto;display:flex;flex-direction:column;gap:8px;margin-bottom:10px;}
  .msg{max-width:70%;padding:8px;border:1px solid #0f0;border-radius:4px;font-size:12px;line-height:1.3;}
  .msg.me{align-self:flex-end;background:rgba(0,255,0,.1);}
  .msg.them{align-self:flex-start;background:rgba(255,0,255,.1);}
  .composer{display:flex;gap:6px;}
  .composer input{flex:1;background:#000;border:1px solid #0f0;color:#0f0;padding:6px;font-size:12px;}
  .composer button{background:#f06;color:#000;font-weight:bold;border:none;padding:6px 10px;cursor:pointer;font-size:12px;}
  #endChatBtn{margin-top:10px;background:#f00;color:#000;font-weight:bold;border:none;padding:6px 10px;cursor:pointer;font-size:12px;}
  #nextChatBtn{margin-top:5px;background:#0ff;color:#000;font-weight:bold;border:none;padding:6px 10px;cursor:pointer;font-size:12px;}
  .countdown{font-size:11px;color:#0ff;margin-top:6px;}
  .hidden-img{filter:blur(6px) brightness(0.4);transition:filter 2s ease;}
</style>
</head>
<body>

<!-- Preloader -->
<div id="loader">
  <h1>Loading EchoMatch</h1>
  <div class="dots"><span></span><span></span><span></span></div>
</div>

<!-- Login Screen -->
<div class="login center" id="login">
  <h1>EchoMatch</h1>
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button id="loginBtn">Login</button>
</div>

<!-- Intro Screen -->
<div class="intro center" id="intro">
  <h1>EchoMatch</h1>
  <div class="glitch" data-text="> Hypothesis: Do people connect better through conversations, not pictures?"></div>
  <p id="typedText"></p>
  <div class="press" id="pressEnter" style="display:none;">â–¶ Press Enter to Start</div>
</div>

<!-- Chat UI -->
<div class="app" id="app">
  <div class="title">EchoMatch: Dating Without Swiping</div>
  <div id="messages" class="messages"></div>
  <div class="composer">
    <input id="msgInput" type="text" placeholder="Say something cool...">
    <button id="sendBtn">Send</button>
  </div>
  <button id="endChatBtn">End Chat</button>
  <button id="nextChatBtn">Next Chat Partner</button>
  <div id="countdown" class="countdown"></div>
  <div id="shareContainer" style="margin-top:10px; display:none;">
    <label for="shareInput" style="color:#0ff;font-size:12px;cursor:pointer;">ðŸ“¤ Share Your Image</label>
    <input type="file" id="shareInput" style="display:none">
  </div>
</div>

<script>
// Elements
const loader=document.getElementById("loader");
const loginEl=document.getElementById("login");
const introEl=document.getElementById("intro");
const appEl=document.getElementById("app");
const messagesEl=document.getElementById("messages");
const inputEl=document.getElementById("msgInput");
const sendBtn=document.getElementById("sendBtn");
const countdownEl=document.getElementById("countdown");
const shareContainer=document.getElementById("shareContainer");
const shareInput=document.getElementById("shareInput");
const typedTextEl=document.getElementById("typedText");
const pressEnterEl=document.getElementById("pressEnter");
const endChatBtn=document.getElementById("endChatBtn");
const nextChatBtn=document.getElementById("nextChatBtn");

// Demo setup
let startedAt=Date.now();
const REVEAL_MS=60*60*1000; // 1 hour profile unlock
const IMAGE_SHARE_MS=60*60*1000; // 1 hour to share image
const demoAvatars=[
  "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=200&h=200&crop=faces&fit=crop",
  "https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200&h=200&crop=faces&fit=crop",
  "https://images.unsplash.com/photo-1545992330-0af7d2d06b8b?w=200&h=200&crop=faces&fit=crop"
];
let currentPartner=0;
let vibeScore=0;

let state={messages:[{sender:"them",text:"Welcome to EchoMatch."},{sender:"them",text:"No swipes. No pics. Just vibes for 1 hour."}]};

// Preloader
window.addEventListener("load",()=>{loader.style.display="none"; loginEl.style.display="flex";});

// Login
document.getElementById("loginBtn").onclick=()=>{
  const u=document.getElementById("username").value.trim();
  const p=document.getElementById("password").value.trim();
  if(u && p){loginEl.style.display="none"; introEl.style.display="flex"; startTypingIntro();} 
  else alert("Enter username and password!");
}

// Typing intro
const descriptionText="We built a dating app where you can't see pictures for 1 hour. Conversation first. Ugly but thought-provoking experiment.";
let descCharIndex=0;
function startTypingIntro(){
  typedTextEl.textContent="";
  const interval=setInterval(()=>{
    typedTextEl.textContent+=descriptionText[descCharIndex];
    descCharIndex++;
    if(descCharIndex>=descriptionText.length){
      clearInterval(interval);
      pressEnterEl.style.display="block";
    }
  },30);
}

// Start App
function startApp(){introEl.style.display="none"; appEl.style.display="flex"; renderMessages(); setInterval(updateCountdown,1000); updateCountdown();}
document.addEventListener("keydown",e=>{
  if(e.key==="Enter" && introEl.style.display!=="none" && descCharIndex>=descriptionText.length){startApp();}
});

// Chat rendering
function renderMessages(){
  messagesEl.innerHTML="";
  state.messages.forEach(m=>{
    const el=document.createElement("div");
    el.className="msg "+m.sender; el.textContent=m.text;
    messagesEl.appendChild(el);
  });
  // Profile image
  const imgWrap=document.createElement("div"); imgWrap.style.position="relative";
  const img=document.createElement("img"); img.src=demoAvatars[currentPartner]; img.style.width="100px";
  if(Date.now()<startedAt+REVEAL_MS){
    img.classList.add("hidden-img");
    const overlay=document.createElement("div"); overlay.style.position="absolute"; overlay.style.inset="0";
    overlay.style.display="flex"; overlay.style.alignItems="center"; overlay.style.justifyContent="center";
    overlay.style.fontSize="10px"; overlay.style.background="rgba(0,0,0,.7)"; overlay.style.color="#fff";
    overlay.textContent="Hidden 1 hour";
    imgWrap.appendChild(img); imgWrap.appendChild(overlay);
  } else {img.classList.remove("hidden-img");}
  messagesEl.appendChild(imgWrap); messagesEl.scrollTop=messagesEl.scrollHeight;
}

// Countdown + Share Unlock
function updateCountdown(){
  const now = Date.now();
  const left = (startedAt + REVEAL_MS) - now;

  if(left <= 0){
    countdownEl.textContent = "Profile picture revealed!";
    renderMessages();
  } else {
    // Convert milliseconds to hh:mm:ss
    const hours = Math.floor(left / (1000*60*60));
    const minutes = Math.floor((left % (1000*60*60)) / (1000*60));
    const seconds = Math.floor((left % (1000*60)) / 1000);
    countdownEl.textContent = `Picture unlocks in ${hours}h ${minutes}m ${seconds}s`;
  }

  // Enable share image only after 1 hour
  if(now >= startedAt + IMAGE_SHARE_MS){
    shareContainer.style.display = "block";
  } else {
    shareContainer.style.display = "none";
  }
}

// Send message
sendBtn.onclick=()=>{
  if(inputEl.disabled) return;
  const txt=inputEl.value.trim();
  if(!txt) return;
  state.messages.push({sender:"me",text:txt});
  inputEl.value="";
  // Fake response
  if(Math.random()<0.5){state.messages.push({sender:"them",text:"Interesting!"}); vibeScore+=10;}
  renderMessages();
};

// Share image
shareInput.addEventListener("change", e=>{
  const file=e.target.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=function(event){
      state.messages.push({sender:"me", text:"Shared an image:"});
      const imgEl=document.createElement("img");
      imgEl.src=event.target.result; imgEl.style.width="100px";
      messagesEl.appendChild(imgEl);
      messagesEl.scrollTop=messagesEl.scrollHeight;
    }
    reader.readAsDataURL(file);
  }
});

// End Chat
endChatBtn.onclick = () => {
  inputEl.disabled=true; sendBtn.disabled=true; endChatBtn.disabled=true;
  state.messages.push({sender:"them",text:"Chat ended by you."}); renderMessages();
};

// Next Chat Partner
nextChatBtn.onclick = () => {
  currentPartner=(currentPartner+1)%demoAvatars.length;
  startedAt=Date.now(); vibeScore=0;
  state={messages:[{sender:"them",text:"New chat partner!"}]};
  inputEl.disabled=false; sendBtn.disabled=false; endChatBtn.disabled=false; shareContainer.style.display="none";
  renderMessages();
};
</script>
</body>
</html>
